nohup: ignoring input
============================================================
Action-Level Fusion Training
============================================================
Start time: 2025-10-13 15:32:23

Configuration:
  model_a: ./baselines/douzero_ADP/landlord_up.ckpt
  model_b: ./baselines/douzero_WP/landlord_up.ckpt
  position: landlord_up
  fusion_type: gating
  num_iterations: 20
  games_per_iteration: 1000
  eval_interval: 1
  eval_games: 1000
  objective: wp
  gate_lr_scale: 0.05
  gate_warmup_iters: 3
  gate_reg_coeff: 0.001
  num_actions: 309
  feature_dim: 512
  lr: 0.0003
  gamma: 0.99
  gae_lambda: 0.95
  clip_epsilon: 0.2
  value_loss_coef: 0.5
  entropy_coef: 0.01
  opponent: perfectdou
  eval_data: ./eval_data_copy.pkl
  device: cuda
  save_dir: checkpoints/action_fusion_landlordup_wp
  save_interval: 100
  resume: None
============================================================
Initializing Action-Level Fusion Trainer...
  Model A: ./baselines/douzero_ADP/landlord_up.ckpt
  Model B: ./baselines/douzero_WP/landlord_up.ckpt
  Position: landlord_up
  Fusion Type: gating
  Device: cuda
  Objective: wp
  Gate LR scale: 0.05
  Gate warmup iters: 3
  Gate reg coeff: 0.001
[GatingFusion Init] target_sigmoid=0.5000, bias=0.0000, expected_gate=0.5000

Starting training for 20 iterations...
  Games per iteration: 1000
  Opponent: perfectdou
------------------------------------------------------------
Best model selection criterion: Win Rate
------------------------------------------------------------

=== Iteration 1/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2261
Updating fusion network...
  Policy Loss: 0.7071
  Value Loss: 1.0222
  Total Loss: 1.2182
  Gate Reg Loss: 0.000000
  Fusion Weights: ADP=50.0% | WP=50.0%

--- Evaluation at iteration 1 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.40%
    Wins: 604, Losses: 396
    Avg Reward (objective WP): 0.2080
    WP Win Rate (metric derived): 60.40% (raw 0.2080)
    Avg ADP: 0.2760
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.7071
    Avg Value Loss: 1.0222
    Avg Training Reward: 0.2261
  >> Current Win Rate: 0.6040
  ✓ New best model saved! Win Rate: 0.6040
    Saved to: checkpoints/action_fusion_landlordup_wp/best_fusion_wp.pt

=== Iteration 2/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2261
Updating fusion network...
  Policy Loss: 0.7071
  Value Loss: 0.9541
  Total Loss: 1.1841
  Gate Reg Loss: 0.000000
  Fusion Weights: ADP=50.0% | WP=50.0%

--- Evaluation at iteration 2 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.40%
    Wins: 604, Losses: 396
    Avg Reward (objective WP): 0.2080
    WP Win Rate (metric derived): 60.40% (raw 0.2080)
    Avg ADP: 0.2760
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.7071
    Avg Value Loss: 0.9541
    Avg Training Reward: 0.2261
  >> Current Win Rate: 0.6040

=== Iteration 3/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2261
Updating fusion network...
  Policy Loss: 0.7071
  Value Loss: 0.9036
  Total Loss: 1.1589
  Gate Reg Loss: 0.000000
  Fusion Weights: ADP=50.0% | WP=50.0%

--- Evaluation at iteration 3 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.40%
    Wins: 604, Losses: 396
    Avg Reward (objective WP): 0.2080
    WP Win Rate (metric derived): 60.40% (raw 0.2080)
    Avg ADP: 0.2760
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.7071
    Avg Value Loss: 0.9036
    Avg Training Reward: 0.2261
  >> Current Win Rate: 0.6040

=== Iteration 4/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2261
Updating fusion network...
  Policy Loss: 0.6106
  Value Loss: 0.8535
  Total Loss: 1.0375
  Gate Reg Loss: 0.000125
  Fusion Weights: ADP=10.1% | WP=89.9%

--- Evaluation at iteration 4 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.90%
    Wins: 609, Losses: 391
    Avg Reward (objective WP): 0.2180
    WP Win Rate (metric derived): 60.90% (raw 0.2180)
    Avg ADP: 0.2430
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.6106
    Avg Value Loss: 0.8535
    Avg Training Reward: 0.2261
  >> Current Win Rate: 0.6090
  ✓ New best model saved! Win Rate: 0.6090
    Saved to: checkpoints/action_fusion_landlordup_wp/best_fusion_wp.pt

=== Iteration 5/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2342
Updating fusion network...
  Policy Loss: 0.5840
  Value Loss: 0.8976
  Total Loss: 1.0330
  Gate Reg Loss: 0.000159
  Fusion Weights: ADP=10.1% | WP=89.9%

--- Evaluation at iteration 5 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.90%
    Wins: 609, Losses: 391
    Avg Reward (objective WP): 0.2180
    WP Win Rate (metric derived): 60.90% (raw 0.2180)
    Avg ADP: 0.2420
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5840
    Avg Value Loss: 0.8976
    Avg Training Reward: 0.2342
  >> Current Win Rate: 0.6090

=== Iteration 6/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2342
Updating fusion network...
  Policy Loss: 0.5840
  Value Loss: 0.8201
  Total Loss: 0.9942
  Gate Reg Loss: 0.000156
  Fusion Weights: ADP=10.9% | WP=89.1%

--- Evaluation at iteration 6 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.60%
    Wins: 606, Losses: 394
    Avg Reward (objective WP): 0.2120
    WP Win Rate (metric derived): 60.60% (raw 0.2120)
    Avg ADP: 0.2360
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5840
    Avg Value Loss: 0.8201
    Avg Training Reward: 0.2342
  >> Current Win Rate: 0.6060

=== Iteration 7/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2342
Updating fusion network...
  Policy Loss: 0.5778
  Value Loss: 0.7467
  Total Loss: 0.9513
  Gate Reg Loss: 0.000150
  Fusion Weights: ADP=11.3% | WP=88.7%

--- Evaluation at iteration 7 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.30%
    Wins: 603, Losses: 397
    Avg Reward (objective WP): 0.2060
    WP Win Rate (metric derived): 60.30% (raw 0.2060)
    Avg ADP: 0.2260
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5778
    Avg Value Loss: 0.7467
    Avg Training Reward: 0.2342
  >> Current Win Rate: 0.6030

=== Iteration 8/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2322
Updating fusion network...
  Policy Loss: 0.5762
  Value Loss: 0.6875
  Total Loss: 0.9201
  Gate Reg Loss: 0.000146
  Fusion Weights: ADP=12.0% | WP=88.0%

--- Evaluation at iteration 8 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.40%
    Wins: 604, Losses: 396
    Avg Reward (objective WP): 0.2080
    WP Win Rate (metric derived): 60.40% (raw 0.2080)
    Avg ADP: 0.2300
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5762
    Avg Value Loss: 0.6875
    Avg Training Reward: 0.2322
  >> Current Win Rate: 0.6040

=== Iteration 9/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2281
Updating fusion network...
  Policy Loss: 0.5770
  Value Loss: 0.6296
  Total Loss: 0.8919
  Gate Reg Loss: 0.000141
  Fusion Weights: ADP=12.3% | WP=87.7%

--- Evaluation at iteration 9 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.50%
    Wins: 605, Losses: 395
    Avg Reward (objective WP): 0.2100
    WP Win Rate (metric derived): 60.50% (raw 0.2100)
    Avg ADP: 0.2340
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5770
    Avg Value Loss: 0.6296
    Avg Training Reward: 0.2281
  >> Current Win Rate: 0.6050

=== Iteration 10/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2240
Updating fusion network...
  Policy Loss: 0.5805
  Value Loss: 0.5799
  Total Loss: 0.8705
  Gate Reg Loss: 0.000126
  Fusion Weights: ADP=15.0% | WP=85.0%

--- Evaluation at iteration 10 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.10%
    Wins: 601, Losses: 399
    Avg Reward (objective WP): 0.2020
    WP Win Rate (metric derived): 60.10% (raw 0.2020)
    Avg ADP: 0.2310
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5805
    Avg Value Loss: 0.5799
    Avg Training Reward: 0.2240
  >> Current Win Rate: 0.6010

=== Iteration 11/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2220
Updating fusion network...
  Policy Loss: 0.5764
  Value Loss: 0.5499
  Total Loss: 0.8515
  Gate Reg Loss: 0.000121
  Fusion Weights: ADP=12.4% | WP=87.6%

--- Evaluation at iteration 11 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.80%
    Wins: 608, Losses: 392
    Avg Reward (objective WP): 0.2160
    WP Win Rate (metric derived): 60.80% (raw 0.2160)
    Avg ADP: 0.2540
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5764
    Avg Value Loss: 0.5499
    Avg Training Reward: 0.2220
  >> Current Win Rate: 0.6080

=== Iteration 12/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2383
Updating fusion network...
  Policy Loss: 0.5693
  Value Loss: 0.5217
  Total Loss: 0.8302
  Gate Reg Loss: 0.000118
  Fusion Weights: ADP=11.7% | WP=88.3%

--- Evaluation at iteration 12 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 61.00%
    Wins: 610, Losses: 390
    Avg Reward (objective WP): 0.2200
    WP Win Rate (metric derived): 61.00% (raw 0.2200)
    Avg ADP: 0.2600
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5693
    Avg Value Loss: 0.5217
    Avg Training Reward: 0.2383
  >> Current Win Rate: 0.6100
  ✓ New best model saved! Win Rate: 0.6100
    Saved to: checkpoints/action_fusion_landlordup_wp/best_fusion_wp.pt

=== Iteration 13/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2383
Updating fusion network...
  Policy Loss: 0.5743
  Value Loss: 0.4956
  Total Loss: 0.8222
  Gate Reg Loss: 0.000121
  Fusion Weights: ADP=10.7% | WP=89.3%

--- Evaluation at iteration 13 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 61.10%
    Wins: 611, Losses: 389
    Avg Reward (objective WP): 0.2220
    WP Win Rate (metric derived): 61.10% (raw 0.2220)
    Avg ADP: 0.2620
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5743
    Avg Value Loss: 0.4956
    Avg Training Reward: 0.2383
  >> Current Win Rate: 0.6110
  ✓ New best model saved! Win Rate: 0.6110
    Saved to: checkpoints/action_fusion_landlordup_wp/best_fusion_wp.pt

=== Iteration 14/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2342
Updating fusion network...
  Policy Loss: 0.5806
  Value Loss: 0.4615
  Total Loss: 0.8115
  Gate Reg Loss: 0.000122
  Fusion Weights: ADP=10.5% | WP=89.5%

--- Evaluation at iteration 14 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.80%
    Wins: 608, Losses: 392
    Avg Reward (objective WP): 0.2160
    WP Win Rate (metric derived): 60.80% (raw 0.2160)
    Avg ADP: 0.2540
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5806
    Avg Value Loss: 0.4615
    Avg Training Reward: 0.2342
  >> Current Win Rate: 0.6080

=== Iteration 15/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2301
Updating fusion network...
  Policy Loss: 0.5816
  Value Loss: 0.4439
  Total Loss: 0.8037
  Gate Reg Loss: 0.000122
  Fusion Weights: ADP=10.4% | WP=89.6%

--- Evaluation at iteration 15 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.70%
    Wins: 607, Losses: 393
    Avg Reward (objective WP): 0.2140
    WP Win Rate (metric derived): 60.70% (raw 0.2140)
    Avg ADP: 0.2530
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5816
    Avg Value Loss: 0.4439
    Avg Training Reward: 0.2301
  >> Current Win Rate: 0.6070

=== Iteration 16/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2281
Updating fusion network...
  Policy Loss: 0.5831
  Value Loss: 0.4352
  Total Loss: 0.8008
  Gate Reg Loss: 0.000122
  Fusion Weights: ADP=10.2% | WP=89.8%

--- Evaluation at iteration 16 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.50%
    Wins: 605, Losses: 395
    Avg Reward (objective WP): 0.2100
    WP Win Rate (metric derived): 60.50% (raw 0.2100)
    Avg ADP: 0.2480
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5831
    Avg Value Loss: 0.4352
    Avg Training Reward: 0.2281
  >> Current Win Rate: 0.6050

=== Iteration 17/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2281
Updating fusion network...
  Policy Loss: 0.5784
  Value Loss: 0.3981
  Total Loss: 0.7775
  Gate Reg Loss: 0.000122
  Fusion Weights: ADP=10.5% | WP=89.5%

--- Evaluation at iteration 17 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.40%
    Wins: 604, Losses: 396
    Avg Reward (objective WP): 0.2080
    WP Win Rate (metric derived): 60.40% (raw 0.2080)
    Avg ADP: 0.2470
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5784
    Avg Value Loss: 0.3981
    Avg Training Reward: 0.2281
  >> Current Win Rate: 0.6040

=== Iteration 18/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2281
Updating fusion network...
  Policy Loss: 0.5871
  Value Loss: 0.4010
  Total Loss: 0.7877
  Gate Reg Loss: 0.000122
  Fusion Weights: ADP=10.6% | WP=89.4%

--- Evaluation at iteration 18 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.20%
    Wins: 602, Losses: 398
    Avg Reward (objective WP): 0.2040
    WP Win Rate (metric derived): 60.20% (raw 0.2040)
    Avg ADP: 0.2330
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5871
    Avg Value Loss: 0.4010
    Avg Training Reward: 0.2281
  >> Current Win Rate: 0.6020

=== Iteration 19/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2301
Updating fusion network...
  Policy Loss: 0.5783
  Value Loss: 0.3814
  Total Loss: 0.7691
  Gate Reg Loss: 0.000122
  Fusion Weights: ADP=12.1% | WP=87.9%

--- Evaluation at iteration 19 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.20%
    Wins: 602, Losses: 398
    Avg Reward (objective WP): 0.2040
    WP Win Rate (metric derived): 60.20% (raw 0.2040)
    Avg ADP: 0.2310
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5783
    Avg Value Loss: 0.3814
    Avg Training Reward: 0.2301
  >> Current Win Rate: 0.6020

=== Iteration 20/20 ===
Collecting 1000 game trajectories...
in game 1: trajectory is none
  Progress: 10/1000 games, collected 9 valid trajectories
  Progress: 20/1000 games, collected 19 valid trajectories
  Progress: 30/1000 games, collected 29 valid trajectories
  Progress: 40/1000 games, collected 39 valid trajectories
in game 45: trajectory is none
in game 47: trajectory is none
  Progress: 50/1000 games, collected 47 valid trajectories
  Progress: 60/1000 games, collected 57 valid trajectories
  Progress: 70/1000 games, collected 67 valid trajectories
  Progress: 80/1000 games, collected 77 valid trajectories
  Progress: 90/1000 games, collected 87 valid trajectories
  Progress: 100/1000 games, collected 97 valid trajectories
  Progress: 110/1000 games, collected 107 valid trajectories
  Progress: 120/1000 games, collected 117 valid trajectories
  Progress: 130/1000 games, collected 127 valid trajectories
  Progress: 140/1000 games, collected 137 valid trajectories
  Progress: 150/1000 games, collected 147 valid trajectories
  Progress: 160/1000 games, collected 157 valid trajectories
  Progress: 170/1000 games, collected 167 valid trajectories
  Progress: 180/1000 games, collected 177 valid trajectories
in game 186: trajectory is none
  Progress: 190/1000 games, collected 186 valid trajectories
  Progress: 200/1000 games, collected 196 valid trajectories
  Progress: 210/1000 games, collected 206 valid trajectories
  Progress: 220/1000 games, collected 216 valid trajectories
  Progress: 230/1000 games, collected 226 valid trajectories
  Progress: 240/1000 games, collected 236 valid trajectories
in game 247: trajectory is none
  Progress: 250/1000 games, collected 245 valid trajectories
  Progress: 260/1000 games, collected 255 valid trajectories
  Progress: 270/1000 games, collected 265 valid trajectories
  Progress: 280/1000 games, collected 275 valid trajectories
in game 287: trajectory is none
  Progress: 290/1000 games, collected 284 valid trajectories
in game 294: trajectory is none
  Progress: 300/1000 games, collected 293 valid trajectories
  Progress: 310/1000 games, collected 303 valid trajectories
  Progress: 320/1000 games, collected 313 valid trajectories
  Progress: 330/1000 games, collected 323 valid trajectories
  Progress: 340/1000 games, collected 333 valid trajectories
  Progress: 350/1000 games, collected 343 valid trajectories
  Progress: 360/1000 games, collected 353 valid trajectories
in game 368: trajectory is none
  Progress: 370/1000 games, collected 362 valid trajectories
  Progress: 380/1000 games, collected 372 valid trajectories
  Progress: 390/1000 games, collected 382 valid trajectories
  Progress: 400/1000 games, collected 392 valid trajectories
  Progress: 410/1000 games, collected 402 valid trajectories
  Progress: 420/1000 games, collected 412 valid trajectories
  Progress: 430/1000 games, collected 422 valid trajectories
  Progress: 440/1000 games, collected 432 valid trajectories
  Progress: 450/1000 games, collected 442 valid trajectories
  Progress: 460/1000 games, collected 452 valid trajectories
in game 467: trajectory is none
  Progress: 470/1000 games, collected 461 valid trajectories
in game 478: trajectory is none
  Progress: 480/1000 games, collected 470 valid trajectories
  Progress: 490/1000 games, collected 480 valid trajectories
  Progress: 500/1000 games, collected 490 valid trajectories
  Progress: 510/1000 games, collected 500 valid trajectories
in game 512: trajectory is none
  Progress: 520/1000 games, collected 509 valid trajectories
  Progress: 530/1000 games, collected 519 valid trajectories
  Progress: 540/1000 games, collected 529 valid trajectories
  Progress: 550/1000 games, collected 539 valid trajectories
  Progress: 560/1000 games, collected 549 valid trajectories
  Progress: 570/1000 games, collected 559 valid trajectories
  Progress: 580/1000 games, collected 569 valid trajectories
  Progress: 590/1000 games, collected 579 valid trajectories
  Progress: 600/1000 games, collected 589 valid trajectories
in game 605: trajectory is none
  Progress: 610/1000 games, collected 598 valid trajectories
in game 612: trajectory is none
  Progress: 620/1000 games, collected 607 valid trajectories
  Progress: 630/1000 games, collected 617 valid trajectories
in game 631: trajectory is none
  Progress: 640/1000 games, collected 626 valid trajectories
  Progress: 650/1000 games, collected 636 valid trajectories
  Progress: 660/1000 games, collected 646 valid trajectories
  Progress: 670/1000 games, collected 656 valid trajectories
  Progress: 680/1000 games, collected 666 valid trajectories
  Progress: 690/1000 games, collected 676 valid trajectories
  Progress: 700/1000 games, collected 686 valid trajectories
  Progress: 710/1000 games, collected 696 valid trajectories
  Progress: 720/1000 games, collected 706 valid trajectories
  Progress: 730/1000 games, collected 716 valid trajectories
  Progress: 740/1000 games, collected 726 valid trajectories
  Progress: 750/1000 games, collected 736 valid trajectories
  Progress: 760/1000 games, collected 746 valid trajectories
  Progress: 770/1000 games, collected 756 valid trajectories
  Progress: 780/1000 games, collected 766 valid trajectories
in game 783: trajectory is none
  Progress: 790/1000 games, collected 775 valid trajectories
  Progress: 800/1000 games, collected 785 valid trajectories
  Progress: 810/1000 games, collected 795 valid trajectories
  Progress: 820/1000 games, collected 805 valid trajectories
  Progress: 830/1000 games, collected 815 valid trajectories
in game 836: trajectory is none
  Progress: 840/1000 games, collected 824 valid trajectories
in game 848: trajectory is none
  Progress: 850/1000 games, collected 833 valid trajectories
in game 856: trajectory is none
  Progress: 860/1000 games, collected 842 valid trajectories
  Progress: 870/1000 games, collected 852 valid trajectories
  Progress: 880/1000 games, collected 862 valid trajectories
  Progress: 890/1000 games, collected 872 valid trajectories
  Progress: 900/1000 games, collected 882 valid trajectories
  Progress: 910/1000 games, collected 892 valid trajectories
  Progress: 920/1000 games, collected 902 valid trajectories
  Progress: 930/1000 games, collected 912 valid trajectories
  Progress: 940/1000 games, collected 922 valid trajectories
  Progress: 950/1000 games, collected 932 valid trajectories
  Progress: 960/1000 games, collected 942 valid trajectories
  Progress: 970/1000 games, collected 952 valid trajectories
  Progress: 980/1000 games, collected 962 valid trajectories
  Progress: 990/1000 games, collected 972 valid trajectories
  Progress: 1000/1000 games, collected 982 valid trajectories
  Collected 982 valid trajectories
  Avg trajectory reward: 0.2301
Updating fusion network...
  Policy Loss: 0.5857
  Value Loss: 0.3724
  Total Loss: 0.7720
  Gate Reg Loss: 0.000122
  Fusion Weights: ADP=12.2% | WP=87.8%

--- Evaluation at iteration 20 ---
Evaluating on 1000 games...
Evaluated 0/1000 games
Evaluated 100/1000 games
Evaluated 200/1000 games
Evaluated 300/1000 games
Evaluated 400/1000 games
Evaluated 500/1000 games
Evaluated 600/1000 games
Evaluated 700/1000 games
Evaluated 800/1000 games
Evaluated 900/1000 games
  Evaluation Results:
    Win Rate: 60.50%
    Wins: 605, Losses: 395
    Avg Reward (objective WP): 0.2100
    WP Win Rate (metric derived): 60.50% (raw 0.2100)
    Avg ADP: 0.2400
  Training Stats (last 1 iters):
    Avg Policy Loss: 0.5857
    Avg Value Loss: 0.3724
    Avg Training Reward: 0.2301
  >> Current Win Rate: 0.6050

============================================================
TRAINING SUMMARY
============================================================
Total Iterations: 20
Training Objective: WP
Best Win Rate: 0.6110
Best model saved to: checkpoints/action_fusion_landlordup_wp/best_fusion_wp.pt

Loss Statistics:
  Final Policy Loss: 0.5857
  Final Value Loss: 0.3724
  Avg Policy Loss (last 20): 0.6003
  Avg Value Loss (last 20): 0.6278

Reward Statistics:
  Final Avg Reward (objective WP): 0.2301
  Avg Reward (objective WP last 20): 0.2299
  Improvement: +0.0041
  Final Avg Reward (WP metric): 0.2301
  Avg Reward (WP metric last 20): 0.2299
  Final Avg Reward (ADP metric): 0.2658
  Avg Reward (ADP metric last 20): 0.2665
============================================================

Training completed! Final model saved to checkpoints/action_fusion_landlordup_wp/final_fusion.pt
Best model saved to checkpoints/action_fusion_landlordup_wp/best_fusion_wp.pt
